// Copyright (c) 2012 Google, Inc. All Rights Reserved.

// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at

// http://www.apache.org/licenses/LICENSE-2.0

// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package ntag

import (
	"fmt"
	"math"
	"testing"
)

func dEquals(a, b float64) bool {
	return math.Abs(a-b) < 1e-6
}

func TestRegulator(t *testing.T) {
	for _, testCase := range regulatorTestCases {
		fmt.Printf("Testing %s\n", testCase.polyString)
		p := ParseIntPoly(testCase.polyString)
		gotr := p.regulatorRealQuad()
		r := testCase.regulator
		if !dEquals(r, gotr) {
			fmt.Printf("Poly %s regulator %f but got %f\n", p, r, gotr)
			t.FailNow()
		}
	}
}

func TestRandomClassNumbers(t *testing.T) {
	for _, testCase := range classNumberTestCases {
		p := ParseIntPoly(testCase.polyString)
		if p.Degree() > 2 {
			continue
		}
		if p.Discriminant().Sign() > 0 {
			continue
		}
		h := testCase.classNumber
		k := MakeNumberField(p)
		hGot := k.ClassNumber()
		if hGot != h {
			fmt.Printf("%s expected class number %d got %d\n", p.String(), h, hGot)
			fmt.Println("Discriminant:", p.Discriminant())
			t.FailNow()
		}
	}
}

func TestParsePolynomial(t *testing.T) {
	testCases := []string{"x^2 + 5*x - 1001", "x^2", "-1*x", "2*x + 1", "x + 1", "x", "1", "2"}
	for _, testCase := range testCases {
		p := ParseIntPoly(testCase).String()
		if p != testCase {
			fmt.Printf("Parsed %s but got %s\n", testCase, p)
			t.FailNow()
		}
	}
}

func TestClassNumber1(t *testing.T) {
	class_number_1_nums := []int{-3, -4, -7, -8, -11, -19, -43, -67, -163}
	class_number_1 := IntSetFromSlice(class_number_1_nums)
	for a := 1; a < 10; a++ {
		for b := -10; b < 10; b++ {
			for c := -10; c < 10; c++ {
				p := MakeIntPolynomial64(int64(c), int64(b), int64(a))
				if !p.IsIrreducible() {
					continue
				}
				if p.Discriminant().Sign() > 0 {
					continue
				}
				if !IsFundamentalDiscriminant(p.Discriminant()) {
					continue
				}
				k := MakeNumberField(p)

				if k.ClassNumber() == 1 && !class_number_1.Contains(int(p.Discriminant().Int64())) {
					t.Fail()
				}
			}
		}
	}
}

// from sage
var regulatorTestCases = []struct {
	polyString string
	regulator  float64
}{
	//{"x^2 - 3*x + 1", 0.481211825059603},
	//{"x^2 - 28*x - 8", 4.605070},
	//{"x^2 - 2", 0.881374},
	//{"x^2 - 23*x - 27", 1.194763},
	{"x^2 + 21*x + 89", 2.209348},
	{"x^2 + 55*x + 65", 7.140452},
	/*{"x^2 + 53*x - 100", 45.757994},
	{"x^2 - 90*x + 95", 16.590624},
	{"x^2 + 86*x + 37", 5.003901},
	{"x^2 + 8*x + 37", 1.000000},
	{"x^2 + 43*x + 21", 4.430958},
	{"x^2 - 21*x + 34", 6.885509},
	{"x^2 - 20*x + 74", 2.312438},
	{"x^2 - 100*x - 13", 37.464669},
	{"x^2 - 13*x - 40", 15.374251},
	{"x^2 + 15*x - 12", 7.282073},
	{"x^2 - 40*x + 51", 9.821192},
	{"x^2 + 71*x - 32", 75.751519},
	{"x^2 - 71*x + 61", 3.137379},
	{"x^2 - 95*x - 30", 33.655174},
	{"x^2 - 27*x - 38", 26.082830},
	{"x^2 - 76*x + 89", 15.109300},
	{"x^2 - 91*x + 43", 4.094622},
	{"x^2 - 43*x - 31", 12.084199},
	{"x^2 - 70*x + 81", 13.932111},
	{"x^2 + 63*x - 44", 26.935851},
	{"x^2 - 5*x + 72", 1.000000},
	{"x^2 - 35*x - 11", 5.246996},
	{"x^2 - 50", 0.881374},
	{"x^2 - 72*x - 27", 1.316958},
	{"x^2 - 90*x + 43", 27.500421},
	{"x^2 + 98*x + 76", 3.366105},
	{"x^2 - 75*x + 66", 81.130782},
	{"x^2 + 98*x + 44", 10.831470},
	{"x^2 + 9*x - 15", 5.246996},
	{"x^2 + 67*x - 92", 13.905759},
	{"x^2 + 5*x + 47", 1.000000},
	{"x^2 - 60*x - 72", 1.316958},
	{"x^2 + 36*x + 22", 15.961821},
	{"x^2 + 6*x + 86", 1.000000},
	{"x^2 - 46*x - 21", 5.976344},
	{"x^2 + 46*x - 67", 4.111143},
	{"x^2 + 29*x + 40", 30.698438},
	{"x^2 - 43*x - 41", 6.511743},
	{"x^2 + 5*x - 57", 7.528869},
	{"x^2 + 3*x + 51", 1.000000},
	{"x^2 + 51*x + 24", 7.601902},
	{"x^2 + 34*x - 59", 4.025033},
	{"x^2 + 2*x + 76", 1.000000},
	{"x^2 + 42*x - 36", 1.965720},
	{"x^2 - 73*x + 38", 58.382536},
	{"x^2 + 92*x + 69", 23.133126},
	{"x^2 + 29*x + 74", 8.274357},
	{"x^2 + 72*x + 26", 27.782604},
	{"x^2 + 50*x + 63", 19.906542},
	{"x^2 - 63*x - 59", 0.481212},
	{"x^2 + 48*x + 94", 6.873163},
	{"x^2 + 84*x + 28", 5.521445},
	{"x^2 - 91*x + 92", 34.815979},
	{"x^2 - 19*x + 71", 2.184644},
	{"x^2 + 46*x - 9", 11.835748},
	{"x^2 + 2*x + 71", 1.000000},
	{"x^2 + 68*x + 41", 16.026008},
	{"x^2 + 79*x + 74", 18.886135},
	{"x^2 - 28*x - 96", 7.666690},
	{"x^2 - 64*x + 25", 6.380120},
	{"x^2 - 51*x - 67", 33.579682},
	{"x^2 + 18*x + 92", 1.000000},
	{"x^2 + 47*x - 70", 51.395315},
	{"x^2 - 32*x + 27", 2.712465},
	{"x^2 + 3*x + 29", 1.000000},
	{"x^2 + 64*x - 76", 2.993223},
	{"x^2 - 43*x + 21", 4.430958},
	{"x^2 + 14*x - 33", 2.893444},
	{"x^2 + 88*x - 15", 82.102270},
	{"x^2 - 95*x - 40", 38.554820},
	{"x^2 + 93*x + 15", 24.669915},
	{"x^2 + 100", 1.000000},
	{"x^2 + 23*x + 32", 3.689504},
	{"x^2 + 34*x + 67", 5.697082},
	{"x^2 - 29*x - 54", 40.711050},
	{"x^2 - 22*x + 18", 13.028176},
	{"x^2 - 93*x - 78", 66.422104},
	{"x^2 - 33*x - 97", 17.118503},
	{"x^2 - 86*x - 91", 3.784706},
	{"x^2 - 46*x + 55", 12.866433},
	{"x^2 - 12*x + 77", 1.000000},
	{"x^2 - 72*x - 96", 4.025033},
	{"x^2 - 80*x + 63", 25.734972},
	{"x^2 - 19*x - 83", 2.184644},
	{"x^2 + 23*x + 8", 14.692551},
	{"x^2 - 40*x - 9", 26.134213},
	{"x^2 + 40*x + 82", 5.365954},
	{"x^2 + 21*x - 87", 10.368007},
	{"x^2 - 86*x + 70", 25.854637},
	{"x^2 + 74*x + 27", 7.695303},
	{"x^2 + 80*x + 60", 12.163489},*/
}

var classNumberTestCases = []struct {
	classNumber int
	polyString  string
}{
	{1, "x^2 - x + 1"},
	{1, "x^2 + x + 1"},
	{2, "x^2 - x + 9"},
	{1, "x^2 + x - 1"},
	{1, "x^2 + 2*x + 3"},
	{1, "x^2 - 3*x - 5"},
	{2, "x^2 + 13*x + 1"},
	{2, "x^2 + 10*x - 1"},
	{1, "x^2 - 3"},
	{1, "x^2 - 2*x + 2"},
	{1, "x^2 - x - 1"},
	{1, "x^2 + 4"},
	{1, "x^2 - x - 8"},
	{2, "x^2 - 9*x + 4"},
	{1, "x^2 + 2"},
	{1, "x^2 + x - 3"},
	{1, "x^2 - x + 2"},
	{3, "x^2 + x + 6"},
	{1, "x^2 - x - 3"},
	{1, "x^2 + 4*x - 2"},
	{2, "x^2 - x + 4"},
	{2, "x^2 + x + 13"},
	{1, "x^2 + 9*x + 6"},
	{1, "x^2 - x + 3"},
	{1, "x^2 + 2*x - 2"},
	{2, "x^2 - 12*x + 1"},
	{1, "x^2 + 5*x - 1"},
	{1, "x^2 + 1"},
	{1, "x^2 - 5*x + 5"},
	{1, "x^2 + 2*x - 1"},
	{1, "x^2 - 51*x + 1"},
	{1, "x^2 - 3*x + 1"},
	{1, "x^2 + x - 23"},
	{2, "x^2 - 20*x - 6"},
	{1, "x^2 + 3*x + 1"},
	{1, "x^2 - 18*x + 1"},
	{2, "x^2 + 2*x + 6"},
	{1, "x^2 + x + 2"},
	{1, "x^2 + 3"},
	{1, "x^2 - 4*x + 5"},
	{11, "x^2 - 72*x - 1"},
	{1, "x^2 - 5"},
	{1, "x^2 - 14*x + 1"},
	{7, "x^2 - x + 160"},
	{1, "x^2 + x + 5"},
	{1, "x^2 + 13*x + 5"},
	{4, "x^2 - 11*x - 6"},
	{1, "x^2 - 8*x + 2"},
	{1, "x^2 - 3*x - 8"},
	{1, "x^2 + 11"},
	{1, "x^2 - 6"},
	{1, "x^2 + 5*x + 7"},
	{1, "x^2 - 1523*x + 1"},
	{1, "x^2 + 17*x - 1"},
	{1, "x^2 + x - 4"},
	{1, "x^2 + 2*x + 2"},
	{2, "x^2 - 6*x - 1"},
	{1, "x^2 - 4*x + 1"},
	{1, "x^2 + 3*x - 2"},
	{2, "x^2 + x + 4"},
	{1, "x^2 + x - 18"},
	{1, "x^2 - 15*x - 4"},
	{2, "x^2 - 19*x - 1"},
	{3, "x^2 + x + 8"},
	{8, "x^2 + 210"},
	{4, "x^2 - x + 10"},
	{1, "x^2 - x - 138"},
	{1, "x^2 - 2*x - 1"},
	{1, "x^2 - x - 4"},
	{1, "x^2 + 7*x - 1"},
	{1, "x^2 + 3*x - 1"},
	{1, "x^2 - 13*x - 2"},
	{1, "x^2 - 22*x - 3"},
	{1, "x^2 + 2*x - 74"},
	{2, "x^2 + 10"},
	{3, "x^2 + 31"},
	{1, "x^2 + 10*x + 13"},
	{2, "x^2 + 6*x - 1"},
	{1, "x^2 - 7*x - 3"},
	{1, "x^2 + 2*x - 6"},
	{1, "x^2 + 22*x + 8"},
	{3, "x^2 - 17*x - 8"},
	{2, "x^2 + 2*x + 7"},
	{1, "x^2 + 6*x + 2"},
	{1, "x^2 + 3*x + 4"},
	{1, "x^2 + 4*x - 10"},
	{1, "x^2 - x - 5"},
	{2, "x^2 + 6"},
	{1, "x^2 - 3*x - 1"},
	{1, "x^2 + 2*x + 4"},
	{1, "x^2 + 31*x - 4"},
	{1, "x^2 + 10*x + 1"},
	{2, "x^2 + 9*x - 1"},
	{1, "x^2 - 2*x + 3"},
	{1, "x^2 - 13*x - 1"},
	{3, "x^2 - x + 8"},
	{1, "x^2 - 12*x - 1"},
	{1, "x^2 - 21"},
	{1, "x^2 - 5*x + 1"},
	{1, "x^2 - 2"},
	{1, "x^3 - x - 3"},
	{6, "x^3 + 10*x^2 + 1"},
	{1, "x^3 + 3*x^2 - x + 1"},
	{1, "x^3 + x^2 - x + 31"},
	{1, "x^3 - x^2 - x - 1"},
	{1, "x^3 - x^2 - 4*x + 2"},
	{19, "x^3 + 88*x^2 - x + 1"},
	{1, "x^3 - 5*x - 3"},
	{1, "x^3 + 2*x^2 - x + 1"},
	{4, "x^3 - x + 49"},
	{1, "x^3 + 4*x^2 + 6"},
	{1, "x^3 + 39*x^2 + x - 2"},
	{1, "x^3 - x + 1"},
	{2, "x^3 - 4*x^2 - 1"},
	{3, "x^3 + 9*x^2 - x + 1"},
	{1, "x^3 - x - 1"},
	{3, "x^3 - 19*x^2 - 8*x - 1"},
	{1, "x^3 - 7*x^2 + x + 1"},
	{1, "x^3 + x^2 + 1"},
	{1, "x^3 + 5*x - 13"},
	{1, "x^3 - 2*x^2 - x + 3"},
	{1, "x^3 - x^2 + 2*x + 1"},
	{1, "x^3 + 5*x - 3"},
	{1, "x^3 - x^2 - 2*x + 1"},
	{1, "x^3 - x^2 - 3*x - 2"},
	{1, "x^3 - 2*x^2 - 25*x - 2"},
	{1, "x^3 + x - 1"},
	{1, "x^3 - x^2 + x - 3"},
	{1, "x^3 + x^2 + x - 1"},
	{8, "x^3 - 32*x^2 - 2"},
	{1, "x^3 + x^2 + 2*x - 1"},
	{1, "x^3 - x^2 - 5*x + 1"},
	{1, "x^3 + 2*x + 1"},
	{1, "x^3 + x^2 + 2*x - 2"},
	{1, "x^3 + 6*x^2 + 2*x + 2"},
	{1, "x^3 - x^2 - 18*x + 11"},
	{3, "x^3 + 20*x^2 + x - 1"},
	{1, "x^3 - 16*x^2 + 2*x + 1"},
	{1, "x^3 + 2*x^2 + x + 5"},
	{1, "x^3 + 2*x^2 - 24*x + 2"},
	{1, "x^3 - 6*x^2 + x + 1"},
	{1, "x^3 + 2*x^2 - x + 3"},
	{1, "x^3 - x^2 - x - 3"},
	{1, "x^3 + x^2 - 81*x - 1"},
	{1, "x^3 + x^2 - x + 1"},
	{1, "x^3 - x^2 + x + 1"},
	{1, "x^3 - 3*x - 1"},
	{1, "x^3 + 5*x^2 + x - 2"},
	{1, "x^3 + x^2 - x + 3"},
	{1, "x^3 - 5*x^2 + x - 1"},
	{6, "x^3 - x^2 + x - 27"},
	{1, "x^3 + x^2 - 7"},
	{3, "x^3 - x^2 + 553*x - 3"},
	{1, "x^3 - x^2 - 13*x - 1"},
	{1, "x^3 + x^2 + x + 2"},
	{1, "x^3 - x^2 - x - 11"},
	{2, "x^3 - x^2 - 32*x + 1"},
	{1, "x^3 + 3*x - 1"},
	{5, "x^3 - x^2 + x - 102"},
	{4, "x^3 - 64*x + 2"},
	{1, "x^3 - 2*x + 6"},
	{1, "x^3 + 12*x^2 + x + 2"},
	{1, "x^3 + 5*x^2 - x + 4"},
	{1, "x^3 - x^2 - 1"},
	{2, "x^3 - 5*x^2 - 3*x + 176"},
	{1, "x^3 - 8*x + 1"},
	{1, "x^3 + x^2 - 2*x + 1"},
	{1, "x^3 - 4*x^2 + x - 6"},
	{2, "x^3 + x^2 + 16*x - 1"},
	{1, "x^3 + 4"},
	{3, "x^3 - 12*x^2 + 1"},
	{1, "x^3 + x^2 + x - 5"},
	{1, "x^3 + 11*x^2 + 2*x + 16"},
	{2, "x^3 + 13*x^2 + 2*x + 1"},
	{4, "x^3 - 2*x^2 + 4*x - 9"},
	{1, "x^3 - 2*x^2 + x - 10"},
	{1, "x^3 + 2*x^2 - x - 3"},
	{1, "x^3 + x^2 - 5*x - 4"},
	{1, "x^3 + x^2 + 5*x - 2"},
	{1, "x^3 - x^2 + 5"},
	{4, "x^3 + 12*x^2 + 2*x + 1"},
	{5, "x^3 - 13*x^2 + x - 1"},
	{1, "x^3 + x^2 - 1"},
	{2, "x^3 + 14*x^2 + 2*x - 1"},
	{1, "x^3 - 3*x^2 + x - 2"},
	{1, "x^3 - x^2 + x - 14"},
	{1, "x^3 + x^2 - 4*x + 7"},
	{1, "x^3 - x^2 - x + 3"},
	{1, "x^3 - x^2 + 2*x - 1"},
	{1, "x^3 + 9*x^2 - 1"},
	{2, "x^3 + x^2 - 664*x - 1"},
	{1, "x^3 + x^2 - 2*x - 1"},
	{1, "x^3 + 2*x - 7"},
	{1, "x^3 + 9*x^2 + 3"},
	{1, "x^3 - x^2 - 4*x + 1"},
	{1, "x^3 - 55*x^2 + 4"},
	{2, "x^3 - 26*x^2 - 2*x + 1"},
	{2, "x^3 - 2*x^2 + 6*x - 1"},
	{1, "x^3 + x^2 + 2*x + 1"},
	{1, "x^3 - 3*x^2 - x + 5"},
	{1, "x^4 - x^2 - 185*x - 13"},
	{1, "x^4 - 3*x^3 + 3*x^2 - x - 6"},
	{1, "x^4 - x^3 - x^2 - 2"},
	{1, "x^4 + x^3 + x^2 + 5*x + 1"},
	{1, "x^4 + 3*x^3 + x^2 + x - 2"},
	{1, "x^4 + 5*x^3 - x^2 - 5*x + 1"},
	{1, "x^4 - 2*x^3 - 1"},
	{1, "x^4 + x^3 + 2*x^2 - x + 1"},
	{1, "x^4 + 2*x^3 - 6*x^2 - 2*x + 3"},
	{1, "x^4 + 4*x^2 - x + 4"},
	{10, "x^4 + x^3 - 27*x - 1"},
	{1, "x^4 + x^3 + 3*x^2 - 2"},
	{1, "x^4 + x^3 + 1"},
	{1, "x^4 - 5*x^2 - 2"},
	{2, "x^4 + 10*x^3 - 7"},
	{1, "x^4 - x^3 - 1"},
	{1, "x^4 - 3*x^3 - x^2 - 4"},
	{2, "x^4 + 4*x^2 + 1"},
	{1, "x^4 + x^3 - x - 4"},
	{1, "x^4 + x^3 + 6*x^2 - 3*x - 1"},
	{5, "x^4 + 38*x^2 - x - 8"},
	{1, "x^4 - 2*x^3 + 4*x^2 + 15"},
	{1, "x^4 + x^3 + 4*x^2 + 1"},
	{1, "x^4 + x^3 - x^2 - x - 1"},
	{3, "x^4 + 2*x^3 + x^2 - 4*x + 8"},
	{1, "x^4 - x^3 - x^2 - 2*x + 1"},
	{1, "x^4 - 4*x^2 + 1"},
	{1, "x^4 - 3*x^2 - 3*x + 1"},
	{1, "x^4 - x^3 - x + 18"},
	{12, "x^4 + 2*x^3 + 11*x^2 - x + 1"},
	{1, "x^4 + x^3 - x^2 + 4*x - 1"},
	{1, "x^4 + 5*x^3 - 1"},
	{1, "x^4 + x^3 + x^2 + x + 1"},
	{3, "x^4 + 19*x^3 + 3*x^2 + x + 2"},
	{2, "x^4 + 16*x^2 + x + 7"},
	{1, "x^4 + 2*x^3 - x^2 - 2*x + 9"},
	{1, "x^4 + 4*x^3 - x^2 - x - 48"},
	{1, "x^4 - x^3 + 3*x^2 + x - 3"},
	{2, "x^4 - x^3 + 129*x^2 - x + 4"},
	{1, "x^4 + 2*x^3 + 2*x^2 - 3*x - 1"},
	{1, "x^4 + x^3 + x^2 + 3*x + 1"},
	{1, "x^4 + x^2 + 3*x - 2"},
	{1, "x^4 - 5*x^3 + 3*x^2 - 3*x - 1"},
	{1, "x^4 - 2*x^2 - x - 5"},
	{1, "x^4 + 2*x^3 - 10*x^2 + x + 1"},
	{1, "x^4 - x^3 + 3*x^2 + x - 2"},
	{4, "x^4 - 476*x^3 - 3*x^2 - x - 3"},
	{1, "x^4 - x^3 - x^2 + x - 1"},
	{12, "x^4 + x^3 - 53*x^2 - 1"},
	{1, "x^4 + 12*x^3 + 1"},
	{1, "x^4 + x^3 - 3*x^2 - x - 1"},
	{1, "x^4 + 12*x^2 - 2*x - 5"},
	{1, "x^4 - x^3 + 2*x^2 + 2*x + 12"},
	{1, "x^4 + 5*x^2 - 5*x + 1"},
	{1, "x^4 + 3*x^3 + x^2 - x + 3"},
	{1, "x^4 + 5*x^3 - x^2 + 5*x + 3"},
	{2, "x^4 - x^3 + 4*x^2 + x + 4"},
	{1, "x^4 + 3*x^3 - 14*x^2 - 2*x - 4"},
	{1, "x^4 - 11*x^2 + x + 1"},
	{1, "x^4 - x^3 + x^2 - x - 2"},
	{1, "x^4 + 3*x^3 - 5*x^2 - 3*x + 2"},
	{1, "x^4 + 3*x^3 - 3*x^2 - x - 4"},
	{1, "x^4 - 3*x^3 - 1"},
	{2, "x^4 + x^3 + 28*x^2 + x + 2"},
	{1, "x^4 + 11*x^3 + 6*x^2 - 65*x + 1"},
	{1, "x^4 + x^3 - 29*x^2 + x - 2"},
	{3, "x^4 - x^3 + 2*x^2 + 7*x - 8"},
	{1, "x^4 - 2*x^3 - 21*x^2 + 4*x - 1"},
	{1, "x^4 + 2*x^2 + x - 1"},
	{1, "x^4 - 20*x^3 - 4*x^2 - 8*x + 2"},
	{1, "x^4 + x^3 - 3*x^2 - x + 5"},
	{1, "x^4 + x^2 - 1"},
	{1, "x^4 + 5*x^3 - x^2 - x - 1"},
	{1, "x^4 - x^3 - x - 2"},
	{1, "x^4 + x^2 + x + 1"},
	{1, "x^4 - x^3 - x^2 - 5*x - 1"},
	{1, "x^4 + 7*x^3 + x^2 - 8*x - 15"},
	{2, "x^4 + 7*x^3 + x^2 + 11*x + 1"},
	{1, "x^4 + x^3 - 10*x^2 - x + 2"},
	{1, "x^4 - x^2 + x + 2"},
	{1, "x^4 + 2*x^3 + 12*x^2 - 2*x - 1"},
	{1, "x^4 - x^3 + 4*x^2 + 2"},
	{1, "x^4 - x^3 - 9*x^2 + 3*x - 2"},
	{1, "x^4 + x^3 + 8*x^2 + x - 2"},
	{1, "x^4 + x^3 - 5"},
	{1, "x^4 - 2*x^2 + 17*x + 2"},
	{1, "x^4 - x^3 + 3*x - 1"},
	{1, "x^4 + x^3 - 2*x^2 + 1"},
	{1, "x^4 - 2*x^3 - x^2 - 2*x - 1"},
	{2, "x^4 + 9*x^3 - x^2 + x + 1"},
	{1, "x^4 - 2*x^3 + 2*x + 1"},
	{1, "x^4 - 3*x^3 + x^2 + 7*x - 2"},
	{1, "x^4 - 2*x^3 + x^2 - 24*x - 1"},
	{1, "x^4 - 6*x^3 + 3*x^2 + x - 3"},
	{1, "x^4 + x^3 + 7*x^2 - 69*x + 4"},
	{1, "x^4 + 5*x^3 - x + 1"},
	{3, "x^4 + 6*x^3 - x^2 + x - 1"},
	{1, "x^4 + x^3 - 4*x - 1"},
	{1, "x^4 + 12*x^2 - 2*x + 7"},
	{1, "x^4 + 2*x^2 + 5*x - 1"}}
